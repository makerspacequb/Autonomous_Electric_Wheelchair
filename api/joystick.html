<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>Robotic Arm API</title>
    <link rel="icon" type="image/ico" href="public/favicon.ico" sizes="16x16">
    <link rel="stylesheet" href="public/style.css">
</head>
        
<body>

    <img class="center" src="public/logo.png" width="150">

    <h1>Wheelchair Joystick Control</h1>
    
    <div id="joystick"></div>

    <h1>Status</h1>

    <p>Left Wheel Speed: <b id="leftWheel">--.-</b>%</p>
    <p>Right Wheel Speed: <b id="rightWheel">--.-</b>%</p>
    <p>Debug Data: <b id="debug">No Data.</b></p>

<script src="public/jquery.min.js"></script>
<script src="public/virtualjoystick.js"></script>

<script>
    var joystick	= new VirtualJoystick({
		container	: document.getElementById('joystick'),
		mouseSupport	: true,
        stationaryBase: false,
        baseX: 200,
        baseY: 300,
		limitStickTravel: true,
		stickRadius: 200,
	    });
</script>

<script>
    setInterval(function(){
        var baseSpeed = (joystick.deltaY()/200)*255;
        var angleFactor = 1/(joystick.deltaX()/200); 
        var leftValue = Math.round(baseSpeed*angleFactor)
	    var rightValue = -Math.round(baseSpeed*angleFactor)
        var wheels = ["send?command=t,l,".concat(leftValue),"send?command=t,r,".concat(rightValue)];
        
        for (var i in wheels){
            $.ajax({
            type: "GET",
            url: wheels[i],
            datatype: "text",
            success: function(status) {
                var wheelSpeed	= document.getElementById('leftWheel');
                wheelSpeed.innerHTML	= leftValue;//Math.round(((leftValue/255)*100),2);
                var wheelSpeed	= document.getElementById('rightWheel');
                wheelSpeed.innerHTML	=  Math.round(((rightWheel/255)*100),2);
                var systemVoltage = document.getElementById('debug');
                systemVoltage.innerHTML	= response;
                console.log(status)
                }
            });
        }
    }, 1/2 * 1000);
</script>

</body>
</html>